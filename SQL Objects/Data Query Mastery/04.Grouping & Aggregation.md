# **üìå Grouping & Aggregation in Oracle SQL**

---

## **1Ô∏è‚É£ What is Aggregation?**

Aggregation means **calculating a single value from multiple rows** using **aggregate functions**.
Common aggregate functions:

| Function  | Description    |
| --------- | -------------- |
| `COUNT()` | Number of rows |
| `SUM()`   | Sum of values  |
| `AVG()`   | Average value  |
| `MIN()`   | Minimum value  |
| `MAX()`   | Maximum value  |

---

## **2Ô∏è‚É£ GROUP BY Clause**

`GROUP BY` is used to **group rows** based on one or more columns so that aggregate functions can be applied to each group.

üìå **Syntax:**

```sql
SELECT column1, column2, AGG_FUNC(column3)
FROM table_name
[WHERE condition]
GROUP BY column1, column2
[ORDER BY column1];
```

---

## **3Ô∏è‚É£ GROUP BY Example**

**Scenario:** Count students in each course.

```sql
SELECT course_id, COUNT(*) AS total_students
FROM students
GROUP BY course_id;
```

‚úÖ Groups all students by `course_id` and counts them.

---

## **4Ô∏è‚É£ HAVING Clause**

`HAVING` is used to filter **groups** (like `WHERE` filters rows).

üìå **Example:** Show courses with more than 3 students.

```sql
SELECT course_id, COUNT(*) AS total_students
FROM students
GROUP BY course_id
HAVING COUNT(*) > 3;
```

---

## **5Ô∏è‚É£ Multiple Columns in GROUP BY**

You can group by **more than one column**.

```sql
SELECT course_id, year, COUNT(*) AS total_students
FROM students
GROUP BY course_id, year
ORDER BY course_id, year;
```

---

## **6Ô∏è‚É£ Advanced Grouping ‚Äì ROLLUP & CUBE**

### **A) ROLLUP**

* Creates **subtotals** and a grand total.
* Works in a **hierarchical** manner.

**Example:**

```sql
SELECT department, course_id, COUNT(*)
FROM students
GROUP BY ROLLUP(department, course_id);
```

üìå Output includes:

1. Count by (department, course\_id)
2. Subtotal for each department
3. Grand total

---

### **B) CUBE**

* Generates **all combinations** of subtotals.

```sql
SELECT department, course_id, COUNT(*)
FROM students
GROUP BY CUBE(department, course_id);
```

üìå Output includes:

1. Count by (department, course\_id)
2. Subtotal by department
3. Subtotal by course\_id
4. Grand total

---

### **C) GROUPING() Function**

* Distinguishes **NULLs from subtotal rows**.

```sql
SELECT department, course_id, COUNT(*),
       GROUPING(department) AS dep_grp,
       GROUPING(course_id) AS course_grp
FROM students
GROUP BY ROLLUP(department, course_id);
```

---

## **7Ô∏è‚É£ Aggregation Without GROUP BY**

Even without `GROUP BY`, aggregate functions can summarize all rows:

```sql
SELECT COUNT(*) AS total_students, AVG(marks) AS avg_marks
FROM students;
```

---

## **8Ô∏è‚É£ Performance Tips**

* Index the columns in `GROUP BY` for large datasets.
* Avoid grouping unnecessary columns.
* Use `HAVING` only for aggregates, and `WHERE` for row filtering before grouping.

---