## üî∑ What is a Procedure?

A **procedure** is a **named block of PL/SQL** that:

* Is stored in the database
* Accepts **parameters (IN, OUT, IN OUT)**
* Contains **business logic** (DML, validation, loops, etc.)
* Is **called explicitly** from SQL or PL/SQL blocks

---

## üîë Parameter Types

| Type     | Description           |
| -------- | --------------------- |
| `IN`     | Input value only      |
| `OUT`    | Output value only     |
| `IN OUT` | Both input and output |

---

## üß± Basic Procedure Structure

```sql
CREATE OR REPLACE PROCEDURE procedure_name (
    param1 IN  datatype,
    param2 OUT datatype,
    param3 IN OUT datatype
)
IS
   -- variable declarations
BEGIN
   -- PL/SQL logic
EXCEPTION
   -- error handling
END;
/
```

---

## üß™ Example 1: Procedure with Only IN Parameters

```sql
create or replace procedure insert_products(
	p_id in number,
	p_name in varchar2,
	price in number,
	stock in number
)
is
begin
	insert into products values(p_id,p_name,price,stock);
	dbms_output.put_line('Product Inserted: ' || p_name);
	
    exception
		when others then 
		dbms_output.put_line('Error: ' || SQLERRM);
end;
/
```

**if any error**
```sql
show error;
```

### ‚ñ∂ How to Call:

```sql
BEGIN
   insert_products(product_seq.nextval, 'Tablet', 15000, 20);
END;
/
```
## üß™ Example : Procedure with insert record in order table

```sql
create or replace procedure insert_order(
    order_id number,
    product_id number,
    order_date date,
    quentity number
)
is
begin

    insert into orders values(order_id,product_id,order_date,quentity);
    dbms_output.put_line('Order Placed: ' || product_id);

    exception

        when others then
        dbms_output.put_line('Error: ' || SQLERRM);
end;
/
```

---

## üß™ Example 2: Procedure with IN and OUT Parameters

```sql
CREATE OR REPLACE PROCEDURE get_stock (
    prod_id IN NUMBER,
    stock_out OUT NUMBER
)
IS
BEGIN
    SELECT stock INTO stock_out
    FROM products
    WHERE p_id = prod_id;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        stock_out := -1;
    WHEN OTHERS THEN
        stock_out := -999;
END;
/
```

### ‚ñ∂ How to Call:

```sql
DECLARE
   v_stock NUMBER;
BEGIN
   get_stock(301, v_stock);
   DBMS_OUTPUT.PUT_LINE('üì¶ Stock: ' || v_stock);
END;
/
```

---

## üß™ Example 3: IN OUT Parameter

```sql
CREATE OR REPLACE PROCEDURE apply_discount (
    p_price IN OUT NUMBER,
    discount IN NUMBER
)
IS
BEGIN
    p_price := p_price - (p_price * discount / 100);
END;
/
```

### ‚ñ∂ Call with IN OUT:

```sql
DECLARE
    v_price NUMBER := 20000;
BEGIN
    apply_discount(v_price, 10);
    DBMS_OUTPUT.PUT_LINE('üí∏ Price after 10% discount: ' || v_price);
END;
/
```

---

## üîç Check Your Procedures

```sql
SELECT object_name, status
FROM user_objects
WHERE object_type = 'PROCEDURE';
```

---

## üßΩ Drop Procedure

```sql
DROP PROCEDURE procedure_name;
```

---

## ‚úÖ Summary

| Feature        | Value                                            |
| -------------- | ------------------------------------------------ |
| Stored In DB   | Yes                                              |
| Parameters     | IN, OUT, IN OUT                                  |
| Called By      | PL/SQL blocks, triggers, jobs, other procs       |
| Returns Value? | No (Use **FUNCTION** if return value is needed)  |
| Used For       | Encapsulate reusable logic (business rules, etc) |

---

## üîç **When Should You Use a Procedure?**

A **procedure** is used when you want to:

---

### ‚úÖ 1. **Encapsulate Business Logic**

> Put complex SQL + PL/SQL logic in one place.

**Example:**

```sql
PROCEDURE apply_bonus(p_emp_id IN NUMBER, p_bonus IN NUMBER)
```

Use Case: Update salary, send email, and log history ‚Äî all in one procedure.

---

### ‚úÖ 2. **Perform a Task (with or without parameters)**

* Insert/Update/Delete data
* Calculate values
* Batch process records

üß™ Example: Add a new product:

```sql
insert_product(p_id, p_name, p_price, p_stock);
```

---

### ‚úÖ 3. **Reuse and Maintain Code Easily**

Instead of writing the same logic again and again, just call the procedure.

‚úî Changes happen in one place
‚úî Reduces duplication

---

### ‚úÖ 4. **Use Parameters to Control Logic**

You can pass:

* Values (`IN`)
* Get results (`OUT`)
* Modify and return data (`IN OUT`)

üß™ Example:

```sql
get_stock(prod_id IN NUMBER, stock_out OUT NUMBER);
```

---

### ‚úÖ 5. **Improve Security**

Users can be **granted EXECUTE permission** on a procedure, without direct access to the table.

üõ° Example:

```sql
GRANT EXECUTE ON insert_order TO app_user;
```

So the user can run the logic, but can‚Äôt write raw SQL on the table.

---

### ‚úÖ 6. **Automate Repetitive Tasks**

Use with **triggers, jobs, or scheduling tools** like DBMS\_SCHEDULER.

üß™ Example:

```sql
PROCEDURE archive_old_orders
```

Run it every month using a scheduled job.

---

### ‚úÖ 7. **Use in Application Logic**

You call procedures from:

* **Java/Python/.NET** apps
* **Forms** and **Reports**
* **APEX** or other Oracle tools

```sql
CallableStatement cs = conn.prepareCall("{call update_customer_status(?, ?)}");
```

---

## ‚ùå When NOT to Use Procedures

| Situation                         | Better Option         |
| --------------------------------- | --------------------- |
| You need to return a single value | Use a **Function**    |
| Logic is only used in one place   | Use **inline PL/SQL** |
| No logic, just raw SQL            | Use **SQL statement** |

---

## üìå Summary

Use a **procedure** when:

* Logic needs to be reused
* You want to manage permissions
* You're automating a process
* You need to manipulate data
* You're working in real apps with multiple steps

## üß† Common Errors in Procedures

| Error Type | Cause                                     |
| ---------- | ----------------------------------------- |
| ORA-00942  | Table/view does not exist                 |
| ORA-00904  | Invalid identifier (column/table typo)    |
| ORA-06550  | Compilation error (syntax or logic issue) |
| ORA-01031  | Insufficient privileges                   |
| PLS-00201  | Identifier must be declared (missing var) |
---
