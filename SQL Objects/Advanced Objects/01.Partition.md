Nice question ğŸ‘ Letâ€™s go step by step.

---

## ğŸ”¹ What is Partitioning in Oracle?

Partitioning means **splitting a large table into smaller, manageable pieces** called **partitions**, but the table is still treated as a single table when queried.

* Each partition can be stored in a **different tablespace**.
* Queries on partitioned tables can be **faster** because Oracle can skip partitions that donâ€™t match.
* Partitioning is often used on **large tables** (millions of rows).

ğŸ‘‰ Types of partitioning:

* **Range Partitioning** â†’ based on ranges of column values (like dates).
* **List Partitioning** â†’ based on a set of values.
* **Hash Partitioning** â†’ distributes rows evenly.
* **Composite Partitioning** â†’ combination.

---

## ğŸ”¹ Your Case: Movies Partition by Release Date

We want:

* Movies released **before 2020** â†’ stored in **TEMP tablespace**
* Movies released **2020 or later** â†’ stored in **USERS tablespace**

---

## âœ… SQL Code

```sql
create table movies (
    movie_id     number primary key,
    title        varchar2(150),
    duration     number,
    release_date date
)
partition by range (release_date) (
    partition old_movies values less than (date '2020-01-01')
        tablespace temp,   -- old movies before 2020 in TEMP tablespace
    partition new_movies values less than (maxvalue)
        tablespace users   -- movies from 2020 onwards in USERS tablespace
);
```

---

## ğŸ”¹ Explanation

1. `partition by range (release_date)` â†’ splits rows based on `release_date`.
2. `partition old_movies values less than (date '2020-01-01')` â†’ all movies released before **1 Jan 2020** go here.

   * Stored in `TEMP` tablespace.
3. `partition new_movies values less than (maxvalue)` â†’ everything else (2020 and beyond).

   * Stored in `USERS` tablespace.

---

## ğŸ”¹ Example Insert

```sql
insert into movies values (1, 'Avatar', 180, date '2009-12-18');
insert into movies values (2, 'RRR', 175, date '2022-03-25');
```

* `'Avatar'` (2009) â†’ goes to **old\_movies** partition (TEMP).
* `'RRR'` (2022) â†’ goes to **new\_movies** partition (USERS).

---

âš ï¸ **Important:**

* You can only use partitioning if your Oracle edition supports it (Enterprise Edition usually).
* `TEMP` tablespace is usually for **sorting, temporary operations**, not for permanent tables. Your DBA might not allow it. In real systems, we normally use two **permanent tablespaces** (like `old_data_ts` and `new_data_ts`).

---

ğŸ‘‰ Do you want me to show you a query that checks **which partition a row went into** after insert?

Perfect ğŸ‘Œ After you insert rows into a **partitioned table**, you can check which partition the row belongs to.

Oracle provides a pseudocolumn:

```sql
ORA_ROWSCN
```

But more useful here is the **`DBMS_ROWID.ROWID_OBJECT`** + **`USER_TAB_PARTITIONS`** join.

---

### âœ… Query to See Partition Name for Each Row

```sql
select movie_id,
       title,
       release_date,
       case 
           when release_date < date '2020-01-01' then 'USERS1'
           else 'USERS'
       end as tablespace_name
from movies
order by release_date;
```

just list partitions and which tablespace they are in:

```sql
select table_name,
       partition_name,
       tablespace_name,
       high_value
from user_tab_partitions
where table_name = 'MOVIES';
```
---

### âœ… Example Output

| MOVIE\_ID | TITLE  | RELEASE\_DATE | PARTITION\_NAME | TABLESPACE\_NAME |
| --------- | ------ | ------------- | --------------- | ---------------- |
| 1         | Avatar | 18-DEC-2009   | OLD\_MOVIES     | TEMP             |
| 2         | RRR    | 25-MAR-2022   | NEW\_MOVIES     | USERS            |

---

### âœ… Quick Test Insert

```sql
insert into movies values (1, 'Avatar', 180, date '2009-12-18');
insert into movies values (2, 'RRR', 175, date '2022-03-25');
commit;
```

Then run the query above â€” youâ€™ll see which **partition** and **tablespace** each row landed in.

---
